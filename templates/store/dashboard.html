{% extends "store/base.html" %}
{% load static %}
{% load querystring from django_tables2 %}
{%load add_filters%}
{% block title %}Dashboard{% endblock title %}

{% block content %}
<!-- Dashboard -->
<div class="d-flex flex-column flex-lg-row h-lg-full bg-surface-secondary">
    {% load static %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    <!-- Main content -->
    <div class="h-screen flex-grow-1 ">
        <!-- Main -->
        {%if request.user.role == 'SH'%}
            {%include 'store/shareholder.html'%}
        {%elif request.user.role == "MR"%}
        <div class="container my-4">
            <div class="card shadow-sm rounded p-3">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h4 class="display-6 mb-0 text-success">Pending Order</h4>
                    </div>
                    <div class="col-md-6 d-flex justify-content-end gap-2">
                        <a class="btn btn-success btn-sm rounded-pill shadow-sm" href="{% querystring '_export'='xlsx' %}">
                            <i class="fa-solid fa-download"></i> Export to Excel
                        </a>
                    </div>
                </div>
               {%include "content/search.html"%}
            </div>
        </div>
        <div class="px-4">
                       {%include 'content/date_navigator.html'%}
            <table class="table table-bordered table-striped table-hover table-sm">
                <thead class="thead-light">
                    <tr>
                        <th scope="col">Order ID <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Client Name <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">thickness (cm) <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Price <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Date <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Price Verification <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">design Verification <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Quantity <i class="fa-solid fa-sort"></i></th>
                        {%if request.user.role == "AD" or request.user.role == "MR"%}
                        <th scope="col">Action</th>
                        {%endif%}
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <th class="nav-item text-center" scope="row"><a class="nav-link text-primary" href="{%url 'product-detail' id=item.id %}">{{ item.id }}</a></th>
                        <td>{{ item.client }}</td>
                        <td>{{ item.thickness }}</td>
                        <td>{%if not item.price  %} - {%else%} {{item.price}} {%endif%}</td>
                        <td>{{ item.date|date:"M d, Y"  }}</td>
                        <td>{%if item.verif_price == "P"  %} Pending {%elif item.verif_price == 'D'%} Declined {%elif item.verif_price == 'W'%} Waiting {%else%} Accepted{%endif%}</td>
                        <td>{%if item.verif_design == "P"  %} Pending {%elif item.verif_design == 'D'%} Declined {%elif item.verif_design == 'W'%} Waiting {%else%} Accepted{%endif%}</td>
                        <td>{%if item.quantity == 0 %} ON DIMENSIONS {%else%}{{item.quantity}}{%endif%}</td>
                        {%if request.user.role == "AD" or request.user == item.user%}
                        <td>
                            <a class="btn btn-outline-info btn-sm py-1" >
                                <i class="fa-solid fa-pen"></i> Edit
                            </a>
                        </td>
                        {%endif%}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {%elif request.user.role == "DR"%}
        <div class="container my-4">
            <div class="card shadow-sm rounded p-3">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h4 class="display-6 mb-0 text-success"> Orders</h4>
                    </div>
                    <div class="col-md-6 d-flex justify-content-end gap-2">
                        <a class="btn btn-success btn-sm rounded-pill shadow-sm" href="{% querystring '_export'='xlsx' %}">
                            <i class="fa-solid fa-download"></i> Export to Excel
                        </a>
                    </div>
                </div>
               {%include "content/search.html"%}
            </div>
        </div>
        <div class="px-4">
           {%include 'content/date_navigator.html'%}
            <table class="table table-bordered table-striped table-hover table-sm">
                <thead class="thead-light">
                    <tr>
                        <th scope="col"><a href="{% querystring table.prefixed_order_by_field=column.order_by_alias.next %}">Order ID <i class="fa-solid fa-sort"></i></a></th>
                        <th scope="col">Client Name <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">thickness (cm) <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Date <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">design Verification <i class="fa-solid fa-sort"></i></th>
                        {%if request.user.role == "AD"%}
                        <th scope="col">Action</th>
                        {%endif%}
                        <th scope="col">Quantity <i class="fa-solid fa-sort"></i></th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <th class="nav-item text-center" scope="row"><a class="nav-link text-primary" href="{%url 'designer-order' id=item.id %}">{{ item.id }}</a></th>
                        <td>{{ item.client }}</td>
                        <td>{{ item.thickness }}</td>
                        <td>{{ item.date|date:"M d, Y"  }}</td>
                        <td>{%if item.verif_design == "P"  %} Pending {%elif item.verif_design == 'D'%} Declined {%elif item.verif_design == 'W'%} Waiting {%else%} Accepted{%endif%}</td>
                        {%if request.user.role == "AD"%}
                        <td>
                            <a class="btn btn-outline-info btn-sm" href="{% url 'product-update' item.id %}">
                                <i class="fa-solid fa-pen"></i> Edit
                            </a>
                            <a class="btn btn-outline-danger btn-sm float-end" href="{% url 'product-delete' item.id %}">
                                <i class="fa-solid fa-trash"></i> Delete
                            </a>
                        </td>
                        {%endif%}
                        <td>{%if item.quantity == 0 %} ON DIMENSIONS {%else%}{{item.quantity}}{%endif%}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {%elif request.user.role == "AT" or  request.user.role == "GM"%}
        <div class="container my-4">
            <div class="card shadow-sm rounded p-3">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h4 class="display-6 mb-0 text-success"> Orders</h4>
                    </div>
                    <div class="col-md-6 d-flex justify-content-end gap-2">
                        <a class="btn btn-success btn-sm rounded-pill shadow-sm" href="{% querystring '_export'='xlsx' %}">
                            <i class="fa-solid fa-download"></i> Export to Excel
                        </a>
                    </div>
                </div>
                {%include "content/search.html"%}
            </div>
        </div>
        <div class="px-4">
                     {%include 'content/date_navigator.html'%}
            <table class="table table-bordered table-striped table-hover table-sm">
                <thead class="thead-light">
                    <tr>
                        <th scope="col"><a href="{% querystring table.prefixed_order_by_field=column.order_by_alias.next %}">Order ID <i class="fa-solid fa-sort"></i></a></th>
                        <th scope="col">Client Name <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">thickness (cm) <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Price <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Date <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Price Verification <i class="fa-solid fa-sort"></i></th>
                        {%if request.user.role == "AD"%}
                        <th scope="col">Action</th>
                        {%endif%}
                        <th scope="col">Quantity <i class="fa-solid fa-sort"></i></th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <th class="nav-item text-center" scope="row"><a class="nav-link text-primary" href="{%url 'account-item' id=item.id %}">{{ item.id }}</a></th>
                        <td>{{ item.client }}</td>
                        <td>{{ item.thickness }}</td>
                        <td>{%if not item.price  %} - {%else%} {{item.price}} {%endif%}</td>
                        <td>{{ item.date|date:"M d, Y"  }}</td>
                        <td>{%if item.verif_price == "P"  %} Pending {%elif item.verif_price == 'D'%} Declined {%elif item.verif_price == 'W'%} Waiting {%else%} Accepted{%endif%}</td>
                        {%if request.user.role == "AD"%}
                        <td>
                            <a class="btn btn-outline-info btn-sm" href="{% url 'product-update' item.id %}">
                                <i class="fa-solid fa-pen"></i> Edit
                            </a>
                            <a class="btn btn-outline-danger btn-sm float-end" href="{% url 'product-delete' item.id %}">
                                <i class="fa-solid fa-trash"></i> Delete
                            </a>
                        </td>
                        {%endif%}
                        <td>{%if item.quantity == 0 %} ON DIMENSIONS {%else%}{{item.quantity}}{%endif%}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>   
        {%elif request.user.role == "OP"%}
        <div class="container my-4">
            <div class="card shadow-sm rounded p-3">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h4 class="display-6 mb-0 text-success">Active Tasks</h4>
                    </div>
                    <div class="col-md-6 d-flex justify-content-end gap-2">
                        <a class="btn btn-success btn-sm rounded-pill shadow-sm" href="{% querystring '_export'='xlsx' %}">
                            <i class="fa-solid fa-download"></i> Export to Excel
                        </a>
                    </div>
                </div>
                              {%include "content/search.html"%}
            </div>
        </div>
        <div class="px-4">
            <div>
                <ul class=" pb-2 list-group list-group-horizontal w-25  gap-2">
                    <a href="{%url_replace request 'sort' 'all'%}" class="list-group-item list-group-item-action py-2 rounded-small {%if request.GET.sort == 'all'  %} active {%endif%}">All </a>
                    <a href="{%url_replace request 'sort' '1' %}" class="list-group-item list-group-item-action py-2 rounded-small {%if request.GET.sort == '1'%} active {%endif%}{%if test|date_week == 1 and not request.GET.sort%}active{%endif%}">Monday</a>
                    <a href="{%url_replace request 'sort' '2' %}" class="list-group-item list-group-item-action py-2 rounded-small {%if request.GET.sort == '2'%} active {%endif%}{%if test|date_week == 2 and not request.GET.sort %}active{%endif%}">Tuesday </a>
                    <a href="{%url_replace request 'sort' '3' %}" class="list-group-item list-group-item-action py-2 rounded-small {%if request.GET.sort == '3'%} active {%endif%}{%if test|date_week == 3 and not request.GET.sort %}active{%endif%}">Wedensday </a>
                    <a href="{%url_replace request 'sort' '4' %}" class="list-group-item list-group-item-action py-2 rounded-small {%if request.GET.sort == '4'%} active {%endif%}{%if test|date_week == 4 and not request.GET.sort %}active{%endif%}">Thursday </a>
                    <a href="{%url_replace request 'sort' '5' %}" class="list-group-item list-group-item-action py-2 rounded-small {%if request.GET.sort == '5'%} active {%endif%}{%if test|date_week == 5 and not request.GET.sort %}active{%endif%}">Friday </a>
                    <a href="{%url_replace request 'sort' '6' %}" class="list-group-item list-group-item-action py-2 rounded-small {%if request.GET.sort == '6'%} active {%endif%}{%if test|date_week == 6 and not request.GET.sort %}active{%endif%}">Saturday</a>
                   </ul>
            </div>
            <table class="table table-bordered table-striped table-hover table-sm">
                <thead class="thead-light">
                    <tr>
                        <th scope="col"><a href="{% querystring table.prefixed_order_by_field=column.order_by_alias.next %}">Order ID <i class="fa-solid fa-sort"></i></a></th>
                        <th scope="col">Client Name <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">thickness (cm) <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Date <i class="fa-solid fa-sort"></i></th>

                        {%if request.user.role == "AD"%}
                        <th scope="col">Action</th>
                        {%endif%}
                        <th scope="col">Quantity <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Status <i class="fa-solid fa-sort"></i></th>

                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <th class="nav-item text-center" scope="row"><a class="nav-link text-primary" href="{%url 'operator-detail' id=item.id %}">{{ item.id }}</a></th>
                        <td>{{ item.client }}</td>
                        <td>{{ item.thickness }}</td>
                        <td>{{ item.date|date:"M d, Y"  }}</td>
                        {%if request.user.role == "AD"%}
                        <td>
                            <a class="btn btn-outline-info btn-sm" href="{% url 'product-update' item.id %}">
                                <i class="fa-solid fa-pen"></i> Edit
                            </a>
                            <a class="btn btn-outline-danger btn-sm float-end" href="{% url 'product-delete' item.id %}">
                                <i class="fa-solid fa-trash"></i> Delete
                            </a>
                        </td>
                        {%endif%}
                        <td>{%if item.quantity == 0 %} ON DIMENSIONS {%else%}{{item.quantity}}{%endif%}</td>
                        <td>{% if item.completed %} <span class=" btn-success rounded-circle px-1"><i class="fa fa-solid fa-check"></i></span>{%else%}<span class="btn-danger rounded-circle px-1"><i class="fa fa-solid fa-close"></i></span>{%endif%}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {%elif request.user.role == "DR"%}
        <div class="container my-4">
            <div class="card shadow-sm rounded p-3">
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <h4 class="display-6 mb-0 text-success">Active Tasks</h4>
                    </div>
                    <div class="col-md-6 d-flex justify-content-end gap-2">
                        <a class="btn btn-success btn-sm rounded-pill shadow-sm" href="{% querystring '_export'='xlsx' %}">
                            <i class="fa-solid fa-download"></i> Export to Excel
                        </a>
                    </div>
                </div>
                              {%include "content/search.html"%}
            </div>
        </div>
        <div class="px-4">
            {%include "content/date_navigator.html" %}
            <table class="table table-bordered table-striped table-hover table-sm">
                <thead class="thead-light">
                    <tr>
                        <th scope="col"><a href="{% querystring table.prefixed_order_by_field=column.order_by_alias.next %}">Order ID <i class="fa-solid fa-sort"></i></a></th>
                        <th scope="col">Client Name <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">thickness (cm) <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Date <i class="fa-solid fa-sort"></i></th>

                        {%if request.user.role == "AD"%}
                        <th scope="col">Action</th>
                        {%endif%}
                        <th scope="col">Quantity <i class="fa-solid fa-sort"></i></th>
                        <th scope="col">Status <i class="fa-solid fa-sort"></i></th>

                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <th class="nav-item text-center" scope="row"><a class="nav-link text-primary" href="{%url 'operator-detail' id=item.id %}">{{ item.id }}</a></th>
                        <td>{{ item.client }}</td>
                        <td>{{ item.thickness }}</td>
                        <td>{{ item.date| date:"M d, Y"  }}</td>
                        {%if request.user.role == "AD"%}
                        <td>
                            <a class="btn btn-outline-info btn-sm" href="{% url 'product-update' item.id %}">
                                <i class="fa-solid fa-pen"></i> Edit
                            </a>
                            <a class="btn btn-outline-danger btn-sm float-end" href="{% url 'product-delete' item.id %}">
                                <i class="fa-solid fa-trash"></i> Delete
                            </a>
                        </td>
                        {%endif%}
                        <td>{%if item.quantity == 0 %} ON DIMENSIONS {%else%}{{item.quantity}}{%endif%}</td>
                        <td>{% if item.completed %} <span class=" btn-success rounded-circle px-1"><i class="fa fa-solid fa-check"></i></span>{%else%}<span class="btn-danger rounded-circle px-1"><i class="fa fa-solid fa-close"></i></span>{%endif%}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {%endif%}
        {% if is_paginated and request.user.role != "SH"%}
    {%include 'content/paginator.html' %}
        {% endif %}
    </div>
</div>
{% endblock content %}

